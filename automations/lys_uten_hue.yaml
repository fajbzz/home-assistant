- id: '1646172012797'
  alias: Lys uten Hue
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: on_press_release
    discovery_id: 0x00178801020e912a action_on_press_release
    id: on_press
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: on_hold_release
    discovery_id: 0x00178801020e912a action_on_hold_release
    id: on_hold
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: up_press_release
    discovery_id: 0x00178801020e912a action_up_press_release
    id: up_press
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: up_hold_release
    discovery_id: 0x00178801020e912a action_up_hold_release
    id: up_hold
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: down_press_release
    discovery_id: 0x00178801020e912a action_down_press_release
    id: down_press
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: down_hold_release
    discovery_id: 0x00178801020e912a action_down_hold_release
    id: down_hold
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: off_press_release
    discovery_id: 0x00178801020e912a action_off_press_release
    id: off_press
  - platform: device
    domain: mqtt
    device_id: 0da02203702a99b5cb616c8fcea949c1
    type: action
    subtype: off_hold_release
    discovery_id: 0x00178801020e912a action_off_hold_release
    id: off_hold
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: on_press
      sequence:
      - service: light.turn_on
        data:
          brightness_pct: 60
        target:
          entity_id: light.livingroom_lights
    - conditions:
      - condition: trigger
        id: off_press
      sequence:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.livingroom_lights
      - condition: time
        after: '21:00'
        before: '05:00'
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.kitchen_lights
    - conditions:
      - condition: trigger
        id: up_press
      sequence:
      - service: light.turn_on
        data:
          brightness_step_pct: 10
        target:
          entity_id: light.livingroom_lights
    - conditions:
      - condition: trigger
        id: down_press
      sequence:
      - service: light.turn_on
        data:
          brightness_step_pct: -10
        target:
          entity_id: light.livingroom_lights
    - conditions:
      - condition: trigger
        id: on_hold
      sequence:
      - service: light.turn_on
        data:
          brightness_pct: 60
        target:
          entity_id: light.kitchen_lights
    - conditions:
      - condition: trigger
        id: off_hold
      sequence:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.kitchen_lights
    - conditions:
      - condition: trigger
        id: up_hold
      sequence:
      - service: light.turn_on
        data:
          brightness_step_pct: 10
        target:
          entity_id: light.kitchen_lights
    - conditions:
      - condition: trigger
        id: down_hold
      sequence:
      - service: light.turn_on
        data:
          brightness_step_pct: -10
        target:
          entity_id: light.kitchen_lights
    default: []
  mode: single

- id: '1653390572240'
  alias: Kjøkken på svakt på kvelden
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.bevegelse_kjokken_occupancy
  condition:
  - condition: device
    type: is_on
    device_id: 2b2fb3d0e3b9d5a4815a9120de84afbb
    entity_id: light.livingroom_lights
    domain: light
  - condition: template
    value_template: '{{ states.automation.kjokken_pa_svakt_pa_kvelden.attributes.current == 0 }}'
  action:
  - choose:
    - conditions:
      - type: is_motion
        condition: device
        device_id: 31f5236faab8ab70132e1e5bb341a5d8
        entity_id: binary_sensor.bevegelse_kjokken_occupancy
        domain: binary_sensor
      sequence:
      - type: turn_on
        device_id: 2336ec55a36729c3797ce9e76358ed13
        entity_id: light.kitchen_lights
        domain: light
        brightness_pct: 95
    default:
    - type: turn_on
      device_id: 2336ec55a36729c3797ce9e76358ed13
      entity_id: light.kitchen_lights
      domain: light
      brightness_pct: 30
  mode: single
- id: '1654601572540'
  alias: Lys på i hagestue
  description: ''
  trigger:
  - platform: numeric_state
    entity_id: sensor.pvlogger_power
    for:
      hours: 0
      minutes: 5
      seconds: 0
    below: '100'
    id: low light
  - platform: time
    at: 01:30:00
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: low light
      - condition: time
        after: '12:00:00'
        before: '23:59:00'
      sequence:
      - type: turn_on
        device_id: d4305c6feca526b0e16cdecff1d937d6
        entity_id: light.hagestue
        domain: light
    - conditions:
      - condition: device
        type: is_on
        device_id: d4305c6feca526b0e16cdecff1d937d6
        entity_id: light.hagestue
        domain: light
      sequence:
      - type: turn_off
        device_id: d4305c6feca526b0e16cdecff1d937d6
        entity_id: light.hagestue
        domain: light
    default: []
  mode: single

- id: '1652905890675'
  alias: Styr lys i gangen
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.shellygang_input
  - platform: state
    entity_id: sensor.howmanyhome
  - platform: template
    value_template: "{{ states.binary_sensor.inngangsdor_door_window.state == 'on' }}"
  - platform: template
    value_template: "{{ states.sensor.pvlogger_power.state|int > 200 and states.switch.shellygang.state == 'off' and states.binary_sensor.anyonehow == 'on' }}"
    id: morning_light
  - platform: template
    value_template: "{{ now().timestamp() - states.binary_sensor.inngangsdor_door_window.last_updated.timestamp() > 600}}"
  condition: 
  - condition: template
    value_template: '{{ states.automation.styr_lys_i_gangen.attributes.current == 0 }}'
  - condition: not
    conditions:
    - condition: template
      value_template: "{{ states('sensor.howmanyhome') == 'unknown' }}"

  action:
  - choose:
    - conditions:
      - condition: trigger
        id: morning_light
      sequence:
      - service: light.turn_on
        data:
          brightness: 100
        target:
          entity_id: light.paere_toalett
    - conditions:
      - condition: state
        entity_id: binary_sensor.shellygang_input
        state: 'off'
      sequence:
      - service: light.turn_on
        data:
          brightness: 4
        target:
          entity_id: light.lys_i_gangen
      - service: light.turn_on
        data:
          brightness: 40
        target:
          entity_id: light.paere_toalett
    - conditions:
      - condition: template
        value_template: '{{ states.sensor.howmanyhome.state|int(default=0) == 0 }}'
      - condition: template
        value_template: "{{ states.binary_sensor.inngangsdor_door_window.state == 'off' }}"
      sequence:
      - service: light.turn_off
        target:
          entity_id: light.lys_i_gangen
        data: {}
      - service: light.turn_on
        data:
          brightness: 40
        target:
          entity_id: light.paere_toalett
    default:
    - service: light.turn_on
      data:
        brightness: 204
      target:
        entity_id: light.lys_i_gangen
    - service: light.turn_on
      data:
        brightness: 200
      target:
        entity_id: light.paere_toalett
  mode: single
